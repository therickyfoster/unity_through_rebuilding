<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Unity Through Rebuilding ‚Äî Peaceweaver Module 25</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- Chart.js for data visualization -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<style>
/* ============================================================
   BASE AESTHETIC ‚Äî Ultimate Enhanced Version
   Photorealistic lighting, particles, dark mode, accessibility
============================================================ */
* { 
  box-sizing: border-box; 
  margin: 0;
  padding: 0;
}

:root {
  --bg-primary: #020308;
  --bg-secondary: #0f172a;
  --bg-tertiary: #1e293b;
  --accent-gold: #fbbf24;
  --accent-purple: #6366f1;
  --accent-pink: #ec4899;
  --text-primary: #f1f5f9;
  --text-secondary: #cbd5e1;
  --border-color: rgba(99, 102, 241, 0.3);
}

[data-theme="light"] {
  --bg-primary: #ffffff;
  --bg-secondary: #f8fafc;
  --bg-tertiary: #e2e8f0;
  --text-primary: #0f172a;
  --text-secondary: #475569;
  --border-color: rgba(99, 102, 241, 0.2);
}

html, body {
  height: 100%;
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  overflow-x: hidden;
  position: relative;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Accessibility - Reduced motion */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ============================================================
   PARTICLE CANVAS
============================================================ */
#particle-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
  opacity: 0.6;
}

body::before {
  content: '';
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at 30% 20%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
              radial-gradient(circle at 70% 80%, rgba(236, 72, 153, 0.12) 0%, transparent 50%),
              radial-gradient(circle at 50% 50%, rgba(16, 24, 48, 0.9) 0%, var(--bg-primary) 100%);
  z-index: 0;
  transition: opacity 0.3s ease;
}

[data-theme="light"] body::before {
  opacity: 0.3;
}

::-webkit-scrollbar { width: 10px; }
::-webkit-scrollbar-track { background: rgba(15, 23, 42, 0.4); }
::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--accent-purple), #7c3aed);
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(79, 70, 229, 0.5);
}

/* ============================================================
   SPLASH SCREEN - Enhanced Unity Animation
============================================================ */
#splash {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at 50% 30%, rgba(99, 102, 241, 0.3) 0%, transparent 60%),
              radial-gradient(circle at top, #1e293b 0%, #0f172a 40%, var(--bg-primary) 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 20px;
  transition: opacity 1.5s ease, transform 1.5s ease;
  z-index: 9999;
  overflow: hidden;
}

/* Unity Canvas Background */
#unity-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  opacity: 0.4;
}

/* Color Waves - Representing unity of colors */
.color-wave {
  position: absolute;
  width: 200%;
  height: 200%;
  opacity: 0.15;
  mix-blend-mode: screen;
  animation: waveFloat 20s ease-in-out infinite;
  border-radius: 40%;
  filter: blur(60px);
}

.wave-blue {
  background: radial-gradient(circle, #0057b7 0%, transparent 70%);
  top: -50%;
  left: -50%;
  animation-delay: 0s;
}

.wave-yellow {
  background: radial-gradient(circle, #ffd700 0%, transparent 70%);
  top: -50%;
  right: -50%;
  animation-delay: 5s;
}

.wave-white {
  background: radial-gradient(circle, #ffffff 0%, transparent 70%);
  bottom: -50%;
  left: -50%;
  animation-delay: 10s;
}

.wave-red {
  background: radial-gradient(circle, #d52b1e 0%, transparent 70%);
  bottom: -50%;
  right: -50%;
  animation-delay: 15s;
}

@keyframes waveFloat {
  0%, 100% { 
    transform: translate(0, 0) rotate(0deg) scale(1);
  }
  25% { 
    transform: translate(10%, -10%) rotate(90deg) scale(1.1);
  }
  50% { 
    transform: translate(-5%, 15%) rotate(180deg) scale(0.9);
  }
  75% { 
    transform: translate(-15%, -5%) rotate(270deg) scale(1.05);
  }
}

/* Floating Unity Elements */
.unity-elements {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.unity-dove,
.unity-hands,
.unity-heart,
.unity-bridge {
  position: absolute;
  font-size: 4rem;
  opacity: 0;
  animation: floatAndFade 15s ease-in-out infinite;
  filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.5));
}

.unity-dove {
  top: 15%;
  left: 10%;
  animation-delay: 0s;
}

.unity-hands {
  top: 20%;
  right: 15%;
  animation-delay: 3s;
}

.unity-heart {
  bottom: 25%;
  left: 12%;
  animation-delay: 6s;
}

.unity-bridge {
  bottom: 20%;
  right: 10%;
  animation-delay: 9s;
}

@keyframes floatAndFade {
  0%, 100% {
    opacity: 0;
    transform: translateY(30px) scale(0.8);
  }
  10%, 40% {
    opacity: 0.6;
    transform: translateY(0) scale(1);
  }
  50%, 90% {
    opacity: 0.6;
    transform: translateY(-20px) scale(1.1);
  }
}

/* Main Content Container */
.splash-content {
  position: relative;
  z-index: 10;
  animation: contentFadeIn 2s ease-out forwards;
}

@keyframes contentFadeIn {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Unity Symbol - Two circles merging */
.unity-symbol {
  position: relative;
  width: 200px;
  height: 100px;
  margin: 20px auto 30px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.unity-circle {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  position: absolute;
  border: 3px solid rgba(255, 255, 255, 0.6);
  box-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
  animation: circlesPulse 4s ease-in-out infinite;
}

.circle-left {
  left: 0;
  background: linear-gradient(135deg, 
    rgba(0, 87, 183, 0.3) 0%,
    rgba(255, 215, 0, 0.3) 100%);
  animation-delay: 0s;
}

.circle-right {
  right: 0;
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.3) 0%,
    rgba(213, 43, 30, 0.3) 100%);
  animation-delay: 0.5s;
}

@keyframes circlesPulse {
  0%, 100% {
    transform: scale(1);
    opacity: 0.8;
  }
  50% {
    transform: scale(1.1);
    opacity: 1;
  }
}

/* Bridge connecting circles */
.unity-bridge-center {
  position: absolute;
  width: 100px;
  height: 4px;
  background: linear-gradient(90deg, 
    rgba(0, 87, 183, 0.6) 0%,
    rgba(251, 191, 36, 0.8) 25%,
    rgba(251, 191, 36, 0.8) 75%,
    rgba(213, 43, 30, 0.6) 100%);
  box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
  animation: bridgeGrow 3s ease-in-out infinite;
}

@keyframes bridgeGrow {
  0%, 100% {
    width: 100px;
    opacity: 0.6;
  }
  50% {
    width: 120px;
    opacity: 1;
  }
}

#splash::before {
  content: '';
  position: absolute;
  width: 800px;
  height: 800px;
  background: radial-gradient(circle, rgba(251, 191, 36, 0.2) 0%, transparent 70%);
  border-radius: 50%;
  filter: blur(100px);
  animation: glowPulse 6s ease-in-out infinite;
}

@keyframes glowPulse {
  0%, 100% { 
    transform: scale(1);
    opacity: 0.3;
  }
  50% { 
    transform: scale(1.3);
    opacity: 0.6;
  }
}

.splash-content h1 {
  font-size: clamp(2.8rem, 5vw, 4.5rem);
  font-weight: 800;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-bottom: 20px;
  background: linear-gradient(135deg, var(--accent-gold), #f59e0b, var(--accent-gold));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: titleGlow 3s ease-in-out infinite;
}

@keyframes titleGlow {
  0%, 100% { filter: drop-shadow(0 0 20px rgba(251, 191, 36, 0.5)); }
  50% { filter: drop-shadow(0 0 40px rgba(251, 191, 36, 0.8)); }
}

.splash-content .subtitle {
  font-size: 1.1rem;
  max-width: 820px;
  line-height: 1.8;
  opacity: 0.95;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
  margin: 0 auto;
}

.splash-content #enter-btn {
  margin-top: 40px;
  padding: 16px 48px;
  font-size: 1.15rem;
  font-weight: 600;
  border-radius: 50px;
  border: 2px solid rgba(251, 191, 36, 0.3);
  background: linear-gradient(135deg, var(--accent-gold), #f59e0b);
  color: #0f172a;
  cursor: pointer;
  box-shadow: 0 0 30px rgba(251, 191, 36, 0.4), 0 8px 16px rgba(0, 0, 0, 0.3);
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  position: relative;
  z-index: 10;
}

.splash-content #enter-btn:hover {
  transform: translateY(-3px) scale(1.05);
  box-shadow: 0 0 50px rgba(251, 191, 36, 0.7), 0 12px 24px rgba(0, 0, 0, 0.4);
  border-color: rgba(251, 191, 36, 0.6);
}

.splash-content #enter-btn:active {
  transform: translateY(-1px) scale(1.02);
}

.splash-exit {
  animation: splashExitEnhanced 1.5s ease forwards;
}

@keyframes splashExitEnhanced {
  0% { 
    opacity: 1; 
    transform: scale(1) rotateY(0deg);
    filter: blur(0px);
  }
  50% {
    opacity: 0.5;
    transform: scale(1.05) rotateY(0deg);
    filter: blur(2px);
  }
  100% { 
    opacity: 0; 
    transform: scale(0.9) rotateY(15deg);
    filter: blur(10px);
  }
}

/* ============================================================
   MAIN APP CONTAINER
============================================================ */
#app {
  opacity: 0;
  display: none;
  transition: opacity 1s ease;
  position: relative;
  z-index: 2;
  min-height: 100vh;
}

/* ============================================================
   HEADER WITH CONTROLS
============================================================ */
header {
  padding: 20px 30px;
  background: rgba(15, 23, 42, 0.7);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border-color);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 100;
  flex-wrap: wrap;
  gap: 15px;
}

#module-title {
  font-size: 1.8rem;
  font-weight: 700;
  letter-spacing: 0.05em;
  background: linear-gradient(135deg, var(--accent-gold), #f59e0b);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.header-controls {
  display: flex;
  gap: 15px;
  align-items: center;
  flex-wrap: wrap;
}

.header-btn, #language-selector {
  padding: 10px 20px;
  background: rgba(99, 102, 241, 0.2);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  color: #e0e7ff;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 0.9rem;
  font-weight: 500;
}

.header-btn:hover, #language-selector:hover {
  background: rgba(99, 102, 241, 0.3);
  box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
}

/* Dark mode toggle */
#theme-toggle {
  width: 50px;
  height: 26px;
  background: rgba(30, 41, 59, 0.8);
  border-radius: 13px;
  position: relative;
  cursor: pointer;
  border: 1px solid var(--border-color);
  transition: background 0.3s ease;
}

#theme-toggle::before {
  content: 'üåô';
  position: absolute;
  left: 2px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.8rem;
  transition: left 0.3s ease, content 0.3s ease;
}

[data-theme="light"] #theme-toggle {
  background: linear-gradient(135deg, var(--accent-purple), #7c3aed);
}

[data-theme="light"] #theme-toggle::before {
  content: '‚òÄÔ∏è';
  left: 24px;
}

/* Search bar */
#search-container {
  position: relative;
  min-width: 250px;
}

#search-input {
  width: 100%;
  padding: 10px 40px 10px 15px;
  background: rgba(15, 23, 42, 0.8);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  color: var(--text-primary);
  font-size: 0.9rem;
}

#search-input:focus {
  outline: none;
  border-color: var(--accent-purple);
  box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
}

#search-icon {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--accent-gold);
  pointer-events: none;
}

/* Search results dropdown */
#search-results {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  margin-top: 5px;
  max-height: 400px;
  overflow-y: auto;
  display: none;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  z-index: 1000;
}

#search-results.active {
  display: block;
}

.search-result-item {
  padding: 12px 15px;
  border-bottom: 1px solid rgba(99, 102, 241, 0.1);
  cursor: pointer;
  transition: background 0.2s ease;
}

.search-result-item:hover {
  background: rgba(99, 102, 241, 0.15);
}

.search-result-title {
  font-weight: 600;
  color: var(--accent-gold);
  margin-bottom: 4px;
}

.search-result-desc {
  font-size: 0.85rem;
  opacity: 0.8;
}

/* ============================================================
   ACHIEVEMENT BADGE SYSTEM
============================================================ */
#achievement-notification {
  position: fixed;
  top: 100px;
  right: -350px;
  width: 320px;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.95), rgba(124, 58, 237, 0.95));
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
  z-index: 10000;
  transition: right 0.5s ease;
}

#achievement-notification.show {
  right: 20px;
}

.achievement-content {
  display: flex;
  align-items: center;
  gap: 15px;
}

.achievement-icon {
  font-size: 3rem;
}

.achievement-text h4 {
  color: white;
  margin-bottom: 5px;
}

.achievement-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

/* Badges display */
#badges-btn {
  position: relative;
}

#badge-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background: var(--accent-pink);
  color: white;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  font-weight: bold;
}

#badges-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10001;
  padding: 20px;
}

#badges-modal.active {
  display: flex;
}

.modal-content {
  background: var(--bg-secondary);
  padding: 30px;
  border-radius: 16px;
  max-width: 600px;
  width: 100%;
  max-height: 80vh;
  overflow-y: auto;
  position: relative;
}

.modal-close {
  position: absolute;
  top: 15px;
  right: 15px;
  font-size: 1.5rem;
  cursor: pointer;
  color: var(--text-secondary);
  background: none;
  border: none;
}

.badges-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.badge-item {
  text-align: center;
  padding: 15px;
  background: rgba(99, 102, 241, 0.1);
  border-radius: 12px;
  border: 2px solid transparent;
  transition: all 0.3s ease;
}

.badge-item.unlocked {
  border-color: var(--accent-gold);
  box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
}

.badge-item.locked {
  opacity: 0.4;
  filter: grayscale(100%);
}

.badge-emoji {
  font-size: 3rem;
  margin-bottom: 8px;
  display: block;
}

.badge-name {
  font-size: 0.9rem;
  font-weight: 600;
  margin-bottom: 4px;
}

.badge-desc {
  font-size: 0.75rem;
  opacity: 0.7;
}

/* ============================================================
   TABLE OF CONTENTS
============================================================ */
#toc {
  position: fixed;
  right: -320px;
  top: 80px;
  width: 300px;
  max-height: calc(100vh - 100px);
  background: rgba(15, 23, 42, 0.95);
  backdrop-filter: blur(20px);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 20px;
  box-shadow: -4px 0 30px rgba(0, 0, 0, 0.5);
  transition: right 0.4s ease;
  z-index: 99;
  overflow-y: auto;
}

#toc.open {
  right: 20px;
}

#toc h3 {
  font-size: 1.2rem;
  margin-bottom: 15px;
  color: var(--accent-gold);
  border-bottom: 2px solid rgba(251, 191, 36, 0.3);
  padding-bottom: 10px;
}

#toc a {
  display: block;
  padding: 8px 12px;
  margin: 5px 0;
  color: var(--text-secondary);
  text-decoration: none;
  border-radius: 6px;
  transition: all 0.2s ease;
  font-size: 0.9rem;
  border-left: 3px solid transparent;
}

#toc a:hover {
  background: rgba(99, 102, 241, 0.2);
  border-left-color: var(--accent-purple);
  padding-left: 16px;
  color: #e0e7ff;
}

/* ============================================================
   PROGRESS TRACKING DASHBOARD
============================================================ */
#progress-dashboard {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(124, 58, 237, 0.15));
  padding: 30px;
  border-radius: 16px;
  margin: 40px 0;
  border: 1px solid var(--border-color);
}

#progress-dashboard h3 {
  color: var(--accent-gold);
  margin-bottom: 20px;
  font-size: 1.8rem;
}

.progress-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
}

.progress-card {
  background: var(--bg-tertiary);
  padding: 20px;
  border-radius: 12px;
  border: 1px solid var(--border-color);
}

.progress-label {
  font-size: 0.9rem;
  opacity: 0.8;
  margin-bottom: 10px;
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: rgba(30, 41, 59, 0.8);
  border-radius: 10px;
  overflow: hidden;
  margin: 15px 0;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent-purple), #7c3aed, var(--accent-pink));
  border-radius: 10px;
  transition: width 1s ease;
  box-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
}

.progress-value {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--accent-gold);
}

/* ============================================================
   INTERACTIVE CHARTS
============================================================ */
.chart-container {
  background: var(--bg-tertiary);
  padding: 25px;
  border-radius: 12px;
  border: 1px solid var(--border-color);
  margin: 30px 0;
}

.chart-container h4 {
  color: var(--accent-gold);
  margin-bottom: 20px;
  font-size: 1.2rem;
}

.chart-canvas {
  position: relative;
  height: 300px;
}

/* ============================================================
   AUDIO/VOICE RECORDING
============================================================ */
.voice-recorder {
  background: rgba(99, 102, 241, 0.1);
  padding: 20px;
  border-radius: 12px;
  border: 1px solid var(--border-color);
  margin: 20px 0;
}

.recorder-controls {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
}

.record-btn {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: 3px solid #ef4444;
  background: rgba(239, 68, 68, 0.2);
  color: #ef4444;
  font-size: 1.5rem;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.record-btn:hover {
  background: rgba(239, 68, 68, 0.3);
  box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
}

.record-btn.recording {
  animation: recordPulse 1.5s ease-in-out infinite;
}

@keyframes recordPulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
  50% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
}

.recording-timer {
  font-size: 1.2rem;
  font-weight: 600;
  color: #ef4444;
}

.audio-playback {
  width: 100%;
  margin-top: 15px;
}

/* ============================================================
   IMAGE UPLOAD & GALLERY
============================================================ */
.image-upload-zone {
  border: 2px dashed var(--border-color);
  border-radius: 12px;
  padding: 40px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  margin: 20px 0;
}

.image-upload-zone:hover {
  border-color: var(--accent-purple);
  background: rgba(99, 102, 241, 0.05);
}

.image-upload-zone.dragover {
  border-color: var(--accent-gold);
  background: rgba(251, 191, 36, 0.1);
}

.upload-icon {
  font-size: 3rem;
  margin-bottom: 10px;
  color: var(--accent-purple);
}

.image-gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
  margin: 20px 0;
}

.gallery-item {
  position: relative;
  aspect-ratio: 1;
  border-radius: 12px;
  overflow: hidden;
  border: 2px solid var(--border-color);
  cursor: pointer;
  transition: all 0.3s ease;
}

.gallery-item:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  border-color: var(--accent-gold);
}

.gallery-item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.gallery-item-remove {
  position: absolute;
  top: 8px;
  right: 8px;
  background: rgba(239, 68, 68, 0.9);
  color: white;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.gallery-item:hover .gallery-item-remove {
  opacity: 1;
}

/* ============================================================
   CASE STUDIES SECTION
============================================================ */
.case-study {
  background: var(--bg-tertiary);
  padding: 30px;
  border-radius: 12px;
  border-left: 4px solid var(--accent-gold);
  margin: 30px 0;
  transition: all 0.3s ease;
}

.case-study:hover {
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  transform: translateX(5px);
}

.case-study-header {
  display: flex;
  justify-content: space-between;
  align-items: start;
  margin-bottom: 15px;
  flex-wrap: wrap;
  gap: 10px;
}

.case-study-title {
  color: var(--accent-gold);
  font-size: 1.4rem;
  font-weight: 600;
}

.case-study-tag {
  background: rgba(99, 102, 241, 0.2);
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.8rem;
  color: var(--accent-purple);
  border: 1px solid var(--border-color);
}

.case-study-location {
  font-size: 0.9rem;
  opacity: 0.8;
  margin-bottom: 15px;
}

.case-study-content {
  line-height: 1.8;
  margin-bottom: 15px;
}

.case-study-impact {
  background: rgba(99, 102, 241, 0.1);
  padding: 15px;
  border-radius: 8px;
  margin-top: 15px;
}

.impact-title {
  font-weight: 600;
  color: var(--accent-gold);
  margin-bottom: 10px;
}

.impact-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
}

.impact-stat {
  text-align: center;
}

.impact-number {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--accent-purple);
}

.impact-label {
  font-size: 0.85rem;
  opacity: 0.8;
}

/* ============================================================
   FAQ SECTION
============================================================ */
.faq-container {
  margin: 30px 0;
}

.faq-item {
  background: var(--bg-tertiary);
  margin: 15px 0;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid var(--border-color);
  transition: all 0.3s ease;
}

.faq-question {
  padding: 20px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 600;
  color: var(--accent-gold);
  transition: background 0.3s ease;
}

.faq-question:hover {
  background: rgba(99, 102, 241, 0.1);
}

.faq-toggle {
  font-size: 1.2rem;
  transition: transform 0.3s ease;
}

.faq-item.active .faq-toggle {
  transform: rotate(180deg);
}

.faq-answer {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease, padding 0.4s ease;
  padding: 0 20px;
}

.faq-item.active .faq-answer {
  max-height: 500px;
  padding: 0 20px 20px 20px;
}

/* ============================================================
   EVENT CALENDAR
============================================================ */
.calendar-container {
  background: var(--bg-tertiary);
  padding: 25px;
  border-radius: 12px;
  border: 1px solid var(--border-color);
  margin: 30px 0;
}

.calendar-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.calendar-month {
  font-size: 1.4rem;
  font-weight: 700;
  color: var(--accent-gold);
}

.calendar-nav {
  display: flex;
  gap: 10px;
}

.calendar-nav-btn {
  background: rgba(99, 102, 241, 0.2);
  border: 1px solid var(--border-color);
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  color: var(--text-primary);
  transition: all 0.3s ease;
}

.calendar-nav-btn:hover {
  background: rgba(99, 102, 241, 0.3);
}

.calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 10px;
}

.calendar-day-label {
  text-align: center;
  font-weight: 600;
  padding: 10px;
  font-size: 0.9rem;
  opacity: 0.7;
}

.calendar-day {
  aspect-ratio: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 8px;
  cursor: pointer;
  position: relative;
  transition: all 0.3s ease;
  border: 1px solid transparent;
}

.calendar-day:hover {
  background: rgba(99, 102, 241, 0.2);
}

.calendar-day.has-event {
  background: rgba(251, 191, 36, 0.1);
  border-color: var(--accent-gold);
  font-weight: 600;
}

.calendar-day.has-event::after {
  content: '';
  position: absolute;
  bottom: 4px;
  width: 6px;
  height: 6px;
  background: var(--accent-gold);
  border-radius: 50%;
}

.event-list {
  margin-top: 20px;
  max-height: 300px;
  overflow-y: auto;
}

.event-item {
  background: rgba(99, 102, 241, 0.1);
  padding: 15px;
  border-radius: 8px;
  margin: 10px 0;
  border-left: 3px solid var(--accent-gold);
}

.event-date {
  font-size: 0.85rem;
  opacity: 0.8;
  margin-bottom: 5px;
}

.event-title {
  font-weight: 600;
  color: var(--accent-gold);
  margin-bottom: 5px;
}

.event-desc {
  font-size: 0.9rem;
  opacity: 0.9;
}

/* ============================================================
   NOTIFICATION SYSTEM
============================================================ */
#notification-container {
  position: fixed;
  top: 100px;
  right: 20px;
  width: 350px;
  max-height: calc(100vh - 120px);
  overflow-y: auto;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.notification {
  background: var(--bg-secondary);
  padding: 15px 20px;
  border-radius: 12px;
  border-left: 4px solid var(--accent-purple);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
  animation: slideInRight 0.3s ease;
  display: flex;
  justify-content: space-between;
  align-items: start;
}

@keyframes slideInRight {
  from {
    transform: translateX(400px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.notification.success {
  border-left-color: #10b981;
}

.notification.warning {
  border-left-color: #f59e0b;
}

.notification.error {
  border-left-color: #ef4444;
}

.notification-content {
  flex: 1;
}

.notification-title {
  font-weight: 600;
  margin-bottom: 4px;
}

.notification-message {
  font-size: 0.9rem;
  opacity: 0.9;
}

.notification-close {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 1.2rem;
  padding: 0;
  margin-left: 10px;
}

/* ============================================================
   PRINT STYLES
============================================================ */
@media print {
  #particle-canvas,
  header,
  #toc,
  #achievement-notification,
  #badges-modal,
  .header-btn,
  #theme-toggle,
  #search-container,
  .action-btn,
  .voice-recorder,
  .image-upload-zone {
    display: none !important;
  }
  
  body {
    background: white;
    color: black;
  }
  
  section {
    page-break-inside: avoid;
  }
  
  .domain-block {
    border: 1px solid #ccc;
    page-break-inside: avoid;
  }
}

/* ============================================================
   SECTIONS & DOMAINS (existing styles continued)
============================================================ */
section {
  padding: 60px 30px;
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
}

section h2 {
  font-size: 2.2rem;
  margin-bottom: 20px;
  color: var(--accent-gold);
  text-shadow: 0 2px 10px rgba(251, 191, 36, 0.3);
  position: relative;
  display: inline-block;
}

section h2::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 0;
  width: 60%;
  height: 3px;
  background: linear-gradient(90deg, var(--accent-gold), transparent);
  border-radius: 2px;
}

section p {
  line-height: 1.8;
  font-size: 1.05rem;
  opacity: 0.9;
  margin-bottom: 20px;
}

.domain-block {
  margin-top: 40px;
  border: 1px solid var(--border-color);
  border-radius: 16px;
  background: rgba(15, 23, 42, 0.6);
  backdrop-filter: blur(10px);
  overflow: hidden;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  transition: all 0.3s ease;
}

.domain-block:hover {
  border-color: rgba(99, 102, 241, 0.4);
  box-shadow: 0 12px 40px rgba(99, 102, 241, 0.2);
  transform: translateY(-2px);
}

.domain-header {
  padding: 24px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(124, 58, 237, 0.1));
  border-bottom: 1px solid rgba(99, 102, 241, 0.1);
  transition: all 0.3s ease;
}

.domain-header:hover {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(124, 58, 237, 0.15));
}

.domain-header h3 {
  font-size: 1.5rem;
  color: #e0e7ff;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 12px;
}

.domain-icon {
  font-size: 1.8rem;
}

.expand-indicator {
  font-size: 1.5rem;
  transition: transform 0.3s ease;
  color: var(--accent-gold);
}

.domain-block.expanded .expand-indicator {
  transform: rotate(180deg);
}

.domain-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.5s ease, padding 0.5s ease;
}

.domain-block.expanded .domain-content {
  max-height: 8000px;
  padding: 30px;
}

.feature-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin: 25px 0;
}

.feature-card {
  padding: 20px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  transition: all 0.3s ease;
  cursor: pointer;
}

.feature-card:hover {
  background: rgba(30, 41, 59, 0.8);
  border-color: rgba(99, 102, 241, 0.4);
  box-shadow: 0 8px 20px rgba(99, 102, 241, 0.2);
  transform: translateY(-4px);
}

.feature-card h4 {
  color: var(--accent-gold);
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.feature-card p {
  font-size: 0.95rem;
  line-height: 1.6;
  opacity: 0.85;
  margin: 0;
}

.action-btn {
  padding: 12px 24px;
  background: linear-gradient(135deg, var(--accent-purple), #7c3aed);
  border: none;
  border-radius: 8px;
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
  margin: 8px 8px 8px 0;
  font-size: 0.95rem;
}

.action-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(99, 102, 241, 0.5);
}

.stat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
  margin: 20px 0;
}

.stat-card {
  padding: 20px;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(124, 58, 237, 0.2));
  border: 1px solid var(--border-color);
  border-radius: 10px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.stat-value {
  font-size: 2.5rem;
  font-weight: 700;
  color: var(--accent-gold);
  margin-bottom: 5px;
  text-shadow: 0 2px 10px rgba(251, 191, 36, 0.3);
}

.stat-label {
  font-size: 0.9rem;
  opacity: 0.8;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.input-group {
  margin: 20px 0;
}

.input-group label {
  display: block;
  margin-bottom: 8px;
  color: var(--text-secondary);
  font-weight: 500;
  font-size: 0.95rem;
}

.input-group input,
.input-group textarea,
.input-group select {
  width: 100%;
  padding: 12px;
  background: rgba(15, 23, 42, 0.8);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  color: var(--text-primary);
  font-size: 1rem;
  transition: all 0.3s ease;
}

.input-group input:focus,
.input-group textarea:focus,
.input-group select:focus {
  outline: none;
  border-color: var(--accent-purple);
  box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
}

.input-group textarea {
  resize: vertical;
  min-height: 100px;
}

/* ============================================================
   FOOTER
============================================================ */
footer {
  background: rgba(15, 23, 42, 0.8);
  backdrop-filter: blur(20px);
  border-top: 1px solid var(--border-color);
  padding: 50px 30px 30px;
  margin-top: 80px;
}

.footer-content {
  max-width: 1200px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 40px;
}

.footer-section h3 {
  color: var(--accent-gold);
  margin-bottom: 15px;
  font-size: 1.2rem;
}

.footer-section p {
  font-size: 0.95rem;
  line-height: 1.7;
  opacity: 0.85;
}

.footer-links {
  list-style: none;
}

.footer-links li {
  margin: 10px 0;
}

.footer-links a {
  color: var(--text-secondary);
  text-decoration: none;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 8px;
}

.footer-links a:hover {
  color: var(--accent-purple);
  padding-left: 5px;
}

.footer-links a::before {
  content: '‚Üí';
  color: var(--accent-gold);
}

.ethics-notice {
  max-width: 1200px;
  margin: 40px auto 20px;
  padding: 20px;
  background: rgba(251, 191, 36, 0.1);
  border: 1px solid rgba(251, 191, 36, 0.3);
  border-radius: 10px;
  text-align: center;
}

.ethics-notice h4 {
  color: var(--accent-gold);
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.copyright {
  text-align: center;
  padding: 20px;
  opacity: 0.6;
  font-size: 0.9rem;
  border-top: 1px solid rgba(99, 102, 241, 0.1);
  margin-top: 30px;
}

/* ============================================================
   RESPONSIVE DESIGN
============================================================ */
@media (max-width: 768px) {
  header {
    flex-direction: column;
    padding: 15px;
  }
  
  #module-title {
    font-size: 1.4rem;
  }
  
  .header-controls {
    width: 100%;
    justify-content: center;
  }
  
  #search-container {
    min-width: 100%;
  }
  
  #toc {
    width: 100%;
    right: -100%;
    top: 70px;
  }
  
  #toc.open {
    right: 0;
  }
  
  section {
    padding: 40px 20px;
  }
  
  section h2 {
    font-size: 1.8rem;
  }
  
  .feature-grid {
    grid-template-columns: 1fr;
  }
  
  .footer-content {
    grid-template-columns: 1fr;
    gap: 30px;
  }
  
  #achievement-notification,
  #notification-container {
    right: 10px;
    left: 10px;
    width: auto;
  }
  
  .modal-content {
    padding: 20px;
  }
  
  .badges-grid {
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
  }
  
  /* Splash screen mobile optimizations */
  .splash-content h1 {
    font-size: clamp(2rem, 8vw, 3rem);
  }
  
  .splash-content .subtitle {
    font-size: 0.95rem;
    padding: 0 15px;
  }
  
  .unity-symbol {
    width: 150px;
    height: 75px;
  }
  
  .unity-circle {
    width: 60px;
    height: 60px;
  }
  
  .unity-bridge-center {
    width: 70px;
  }
  
  .unity-dove,
  .unity-hands,
  .unity-heart,
  .unity-bridge {
    font-size: 2.5rem;
  }
  
  .splash-content #enter-btn {
    padding: 14px 36px;
    font-size: 1rem;
  }
}

/* ============================================================
   ANIMATIONS
============================================================ */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fade-in-up {
  animation: fadeInUp 0.6s ease forwards;
}

@keyframes shimmer {
  0% { background-position: -1000px 0; }
  100% { background-position: 1000px 0; }
}

.shimmer {
  background: linear-gradient(90deg, 
    transparent, 
    rgba(99, 102, 241, 0.2), 
    transparent);
  background-size: 1000px 100%;
  animation: shimmer 2s infinite;
}

/* Loading spinner */
.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid rgba(99, 102, 241, 0.2);
  border-top-color: var(--accent-purple);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

</style>
</head>

<body>

<!-- Particle Canvas -->
<canvas id="particle-canvas"></canvas>

<!-- Achievement Notification -->
<div id="achievement-notification">
  <div class="achievement-content">
    <span class="achievement-icon">üèÜ</span>
    <div class="achievement-text">
      <h4 id="achievement-title">Achievement Unlocked!</h4>
      <p id="achievement-desc">First steps toward unity</p>
    </div>
  </div>
</div>

<!-- Notification Container -->
<div id="notification-container"></div>

<!-- Badges Modal -->
<div id="badges-modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeBadgesModal()">√ó</button>
    <h2 style="color: var(--accent-gold); margin-bottom: 10px;">Your Achievements</h2>
    <p style="opacity: 0.8; margin-bottom: 20px;">Track your peace-building journey</p>
    <div class="badges-grid" id="badges-container">
      <!-- Badges will be populated by JavaScript -->
    </div>
  </div>
</div>

<!-- Splash Screen with Unity Animation -->
<div id="splash">
  <!-- Animated Unity Canvas -->
  <canvas id="unity-canvas"></canvas>
  
  <!-- Floating Elements -->
  <div class="unity-elements">
    <div class="unity-dove">üïäÔ∏è</div>
    <div class="unity-hands">ü§ù</div>
    <div class="unity-heart">üíô</div>
    <div class="unity-bridge">üåâ</div>
  </div>
  
  <!-- Color Waves representing unity -->
  <div class="color-wave wave-blue"></div>
  <div class="color-wave wave-yellow"></div>
  <div class="color-wave wave-white"></div>
  <div class="color-wave wave-red"></div>
  
  <!-- Main Content -->
  <div class="splash-content">
    <h1>UNITY THROUGH REBUILDING</h1>
    <div class="unity-symbol">
      <div class="unity-circle circle-left"></div>
      <div class="unity-circle circle-right"></div>
      <div class="unity-bridge-center"></div>
    </div>
    <div class="subtitle">
      Module 25 of the Peaceweaver Framework.  
      A comprehensive platform for cross-border reconstruction,  
      civic empowerment, ecological restoration, and multi-generational healing.
      <br><br>
      <strong>12 integrated domains</strong> ‚Ä¢ Interactive tools ‚Ä¢ Real-world application guides
      <br>
      Built for post-conflict communities, ecological restoration teams, and peace-builders worldwide.
    </div>
    <button id="enter-btn">Enter Module</button>
  </div>
</div>

<!-- Main Application -->
<div id="app">

<!-- Header -->
<header>
  <div id="module-title">Unity Through Rebuilding</div>
  <div class="header-controls">
    <div id="search-container">
      <input type="text" id="search-input" placeholder="Search domains, features, resources..." aria-label="Search">
      <span id="search-icon">üîç</span>
      <div id="search-results"></div>
    </div>
    <select id="language-selector" aria-label="Language">
      <option value="en">English</option>
      <option value="ru">–†—É—Å—Å–∫–∏–π</option>
      <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
    </select>
    <div id="theme-toggle" role="button" aria-label="Toggle dark/light mode" tabindex="0"></div>
    <button class="header-btn" id="badges-btn" aria-label="View achievements">
      üèÜ Badges
      <span id="badge-count">0</span>
    </button>
    <button class="header-btn" id="toc-toggle">Navigation ‚ò∞</button>
  </div>
</header>

<!-- Table of Contents -->
<div id="toc" role="navigation" aria-label="Table of contents">
  <h3>Navigation</h3>
  <a href="#intro">Introduction</a>
  <a href="#progress">Progress Dashboard</a>
  <a href="#physical">1. Physical Reconstruction</a>
  <a href="#case-studies">Case Studies</a>
  <a href="#faq">FAQ</a>
  <a href="#calendar">Events Calendar</a>
  <a href="#resources">Resources & Partners</a>
</div>

<!-- Introduction Section -->
<section id="intro" class="fade-in-up">
  <h2>üïäÔ∏è Why Rebuilding Unifies</h2>
  <p>
    In post-conflict regions, rebuilding transcends mere physical reconstruction‚Äîit becomes a profound act of collective healing that weaves together civic trust, emotional reconciliation, ecological restoration, intergenerational dialogue, and shared mythology.
  </p>
  
  <div class="stat-grid">
    <div class="stat-card">
      <div class="stat-value">12</div>
      <div class="stat-label">Rebuilding Domains</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">‚àû</div>
      <div class="stat-label">Healing Pathways</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">100%</div>
      <div class="stat-label">Open Source</div>
    </div>
  </div>
</section>

<!-- Progress Dashboard -->
<section id="progress">
  <div id="progress-dashboard">
    <h3>üìä Your Peacebuilding Progress</h3>
    <div class="progress-grid">
      <div class="progress-card">
        <div class="progress-label">Domains Explored</div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-domains" style="width: 0%;"></div>
        </div>
        <div class="progress-value"><span id="domains-count">0</span>/12</div>
      </div>
      <div class="progress-card">
        <div class="progress-label">Tools Activated</div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-tools" style="width: 0%;"></div>
        </div>
        <div class="progress-value"><span id="tools-count">0</span>/48</div>
      </div>
      <div class="progress-card">
        <div class="progress-label">Contributions Made</div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-contributions" style="width: 0%;"></div>
        </div>
        <div class="progress-value" id="contributions-count">0</div>
      </div>
    </div>
    
    <!-- Interactive Chart -->
    <div class="chart-container">
      <h4>Community Engagement Over Time</h4>
      <div class="chart-canvas">
        <canvas id="engagement-chart"></canvas>
      </div>
    </div>
  </div>
</section>

<!-- Physical Reconstruction Domain (Example with all features) -->
<section id="physical">
  <h2>1. Physical Reconstruction</h2>
  
  <div class="domain-block">
    <div class="domain-header">
      <h3><span class="domain-icon">üèóÔ∏è</span> Infrastructure of Healing</h3>
      <span class="expand-indicator">‚ñº</span>
    </div>
    <div class="domain-content">
      
      <p>
        Physical reconstruction is the visible manifestation of peace‚Äîevery rebuilt home, repaired bridge, and restored school serves as a testament to collective commitment.
      </p>

      <div class="feature-grid">
        <div class="feature-card">
          <h4>üó∫Ô∏è Rebuild Coordination Hub</h4>
          <p>Interactive mapping system connecting damaged infrastructure with repair teams, materials, and funding sources.</p>
        </div>
        <div class="feature-card">
          <h4>ü§ù Cross-Border Volunteer Network</h4>
          <p>Matching skilled workers from both nations with projects that need their expertise.</p>
        </div>
        <div class="feature-card">
          <h4>üìã Ethical Rebuild Standards</h4>
          <p>Safety protocols, accessibility guidelines, and cultural preservation frameworks.</p>
        </div>
        <div class="feature-card">
          <h4>üè† Home Blessing Rituals</h4>
          <p>Multicultural ceremonies to honor renewed dwellings and welcome families back.</p>
        </div>
      </div>

      <!-- Voice Recording for Testimonies -->
      <h4 style="margin-top: 30px; color: var(--accent-gold);">Share Your Story</h4>
      <div class="voice-recorder">
        <p style="opacity: 0.9; margin-bottom: 15px;">Record a testimony about reconstruction efforts in your community</p>
        <div class="recorder-controls">
          <button class="record-btn" id="record-btn-1" aria-label="Record audio">üéôÔ∏è</button>
          <span class="recording-timer" id="timer-1">00:00</span>
          <button class="action-btn" id="stop-btn-1" style="display: none;">Stop Recording</button>
          <button class="action-btn" id="save-btn-1" style="display: none;">Save Testimony</button>
        </div>
        <audio class="audio-playback" id="playback-1" controls style="display: none;"></audio>
      </div>

      <!-- Image Upload Gallery -->
      <h4 style="margin-top: 30px; color: var(--accent-gold);">Document Progress</h4>
      <div class="image-upload-zone" id="upload-zone-1">
        <div class="upload-icon">üì∏</div>
        <p>Click or drag images to upload before/after photos</p>
        <input type="file" id="file-input-1" accept="image/*" multiple style="display: none;">
      </div>
      <div class="image-gallery" id="gallery-1"></div>

      <button class="action-btn" onclick="trackAction('Submit Project')">Submit Project</button>
      <button class="action-btn" onclick="trackAction('Find Volunteers')">Find Volunteers</button>
      <button class="action-btn" onclick="downloadPDF('Reconstruction Toolkit')">Download Toolkit (PDF)</button>

    </div>
  </div>
</section>

<!-- Case Studies Section -->
<section id="case-studies">
  <h2>üìö Real-World Case Studies</h2>
  <p>Learn from successful peace-building and reconstruction efforts around the world</p>

  <div class="case-study">
    <div class="case-study-header">
      <h3 class="case-study-title">Northern Ireland Peace Process</h3>
      <span class="case-study-tag">Completed</span>
    </div>
    <div class="case-study-location">üìç Belfast, Northern Ireland ‚Ä¢ 1998-Present</div>
    <div class="case-study-content">
      <p>The Good Friday Agreement of 1998 ended decades of conflict known as "The Troubles." The peace process demonstrated how former adversaries could collaborate on shared governance, economic development, and cultural reconciliation. Key elements included power-sharing arrangements, cross-border cooperation with the Republic of Ireland, and community-led reconciliation initiatives.</p>
    </div>
    <div class="case-study-impact">
      <div class="impact-title">Measurable Impact</div>
      <div class="impact-stats">
        <div class="impact-stat">
          <div class="impact-number">90%+</div>
          <div class="impact-label">Violence Reduction</div>
        </div>
        <div class="impact-stat">
          <div class="impact-number">25</div>
          <div class="impact-label">Years of Peace</div>
        </div>
        <div class="impact-stat">
          <div class="impact-number">100+</div>
          <div class="impact-label">Joint Programs</div>
        </div>
      </div>
    </div>
  </div>

  <div class="case-study">
    <div class="case-study-header">
      <h3 class="case-study-title">Rwanda Reconciliation Villages</h3>
      <span class="case-study-tag">Ongoing</span>
    </div>
    <div class="case-study-location">üìç Multiple regions, Rwanda ‚Ä¢ 2005-Present</div>
    <div class="case-study-content">
      <p>Following the 1994 genocide, Rwanda established "reconciliation villages" where genocide survivors and perpetrators who had served their sentences lived as neighbors. Through facilitated dialogue, shared economic projects, and community building, these villages demonstrated that even the deepest wounds could begin to heal through proximity, accountability, and collective purpose.</p>
    </div>
    <div class="case-study-impact">
      <div class="impact-title">Measurable Impact</div>
      <div class="impact-stats">
        <div class="impact-stat">
          <div class="impact-number">50,000+</div>
          <div class="impact-label">Families Reunited</div>
        </div>
        <div class="impact-stat">
          <div class="impact-number">85%</div>
          <div class="impact-label">Report Positive Relations</div>
        </div>
        <div class="impact-stat">
          <div class="impact-number">200+</div>
          <div class="impact-label">Villages Established</div>
        </div>
      </div>
    </div>
  </div>

  <div class="case-study">
    <div class="case-study-header">
      <h3 class="case-study-title">Colombia Peace Accords</h3>
      <span class="case-study-tag">In Progress</span>
    </div>
    <div class="case-study-location">üìç Colombia ‚Ä¢ 2016-Present</div>
    <div class="case-study-content">
      <p>After 52 years of armed conflict between the government and FARC guerrillas, the 2016 peace agreement created pathways for disarmament, victim reparations, rural development, and political participation. The accords emphasized transitional justice, allowing former combatants to reintegrate while ensuring accountability through truth-telling and community service rather than solely punitive measures.</p>
    </div>
    <div class="case-study-impact">
      <div class="impact-title">Measurable Impact</div>
      <div class="impact-stats">
        <div class="impact-stat">
          <div class="impact-number">13,000+</div>
          <div class="impact-label">Combatants Disarmed</div>
        </div>
        <div class="impact-stat">
          <div class="impact-number">70%</div>
          <div class="impact-label">Violence Decline</div>
        </div>
        <div class="impact-stat">
          <div class="impact-number">300+</div>
          <div class="impact-label">Reintegration Centers</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FAQ Section -->
<section id="faq">
  <h2>‚ùì Frequently Asked Questions</h2>
  
  <div class="faq-container">
    <div class="faq-item">
      <div class="faq-question">
        <span>How can this platform be used in actual post-conflict zones?</span>
        <span class="faq-toggle">‚ñº</span>
      </div>
      <div class="faq-answer">
        <p>This platform serves as both a planning framework and a coordination tool. Communities can adapt each domain to their specific context, using the interactive features to map needs, connect volunteers, track progress, and share resources. The offline-first design (when fully implemented) ensures functionality even in areas with limited connectivity. Local organizations can customize the tools, translate content into additional languages, and integrate with existing community systems.</p>
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        <span>What makes this approach different from traditional reconstruction?</span>
        <span class="faq-toggle">‚ñº</span>
      </div>
      <div class="faq-answer">
        <p>Traditional reconstruction often focuses solely on physical infrastructure. This platform recognizes that lasting peace requires simultaneously addressing physical, ecological, cultural, emotional, economic, educational, civic, mythic, technological, agricultural, relational, and intergenerational dimensions. By integrating all twelve domains, communities avoid the common pitfall of rebuilding structures while leaving divisions intact. The emphasis on cross-border collaboration and shared ownership ensures that reconstruction becomes a unifying force rather than a source of further division.</p>
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        <span>Is this platform only for Russia-Ukraine reconciliation?</span>
        <span class="faq-toggle">‚ñº</span>
      </div>
      <div class="faq-answer">
        <p>While specifically designed with Russia-Ukraine reconciliation in mind, the framework is universally applicable to any post-conflict situation. The twelve domains of rebuilding are fundamental to human communities regardless of geography or specific conflict. Organizations working in other divided regions‚Äîfrom Cyprus to Kashmir, Sudan to Cyprus‚Äîcan adapt the tools, translate the content, and customize the features to their unique cultural and political contexts.</p>
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        <span>How do you ensure safety and prevent misuse?</span>
        <span class="faq-toggle">‚ñº</span>
      </div>
      <div class="faq-answer">
        <p>Safety is built into every layer. All data processing is local and user-controlled. There's no hidden tracking or telemetry. Privacy protections are mandatory for sensitive features like the family reconnection tools. Content moderation guidelines prevent the platform from being weaponized for harassment or manipulation. The "Zero Harm & Anti-Coercion" commitment means any feature that could enable harm is removed or redesigned. Community safety always takes precedence over feature complexity.</p>
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        <span>Can individuals use this, or is it only for organizations?</span>
        <span class="faq-toggle">‚ñº</span>
      </div>
      <div class="faq-answer">
        <p>Both! Individual community members can use the platform to find volunteer opportunities, submit projects, share cultural contributions, access mental health resources, and connect with others. Organizations can use it to coordinate larger initiatives, track progress across multiple domains, and facilitate collaboration. The platform scales from individual actions to community-wide movements, recognizing that peace is built through both grassroots participation and structured coordination.</p>
      </div>
    </div>

    <div class="faq-item">
      <div class="faq-question">
        <span>What about people without internet access?</span>
        <span class="faq-toggle">‚ñº</span>
      </div>
      <div class="faq-answer">
        <p>The platform is designed with offline functionality in mind. Key resources can be downloaded as PDFs for printing and distribution. The community mesh network tools help establish local connectivity. Mobile apps can sync when connection is available. The framework itself can be implemented through in-person gatherings, paper-based tracking, and community radio, ensuring that digital access never becomes a barrier to participation in peace-building.</p>
      </div>
    </div>
  </div>
</section>

<!-- Events Calendar -->
<section id="calendar">
  <h2>üìÖ Peace-Building Events Calendar</h2>
  
  <div class="calendar-container">
    <div class="calendar-header">
      <div class="calendar-month" id="calendar-month">December 2025</div>
      <div class="calendar-nav">
        <button class="calendar-nav-btn" id="prev-month">‚Üê Previous</button>
        <button class="calendar-nav-btn" id="next-month">Next ‚Üí</button>
      </div>
    </div>
    
    <div class="calendar-grid" id="calendar-grid">
      <!-- Calendar will be populated by JavaScript -->
    </div>
    
    <div class="event-list" id="event-list">
      <div class="event-item">
        <div class="event-date">December 10, 2025</div>
        <div class="event-title">Human Rights Day Commemoration</div>
        <div class="event-desc">Joint ceremony honoring human dignity and shared values</div>
      </div>
      <div class="event-item">
        <div class="event-date">December 21, 2025</div>
        <div class="event-title">Winter Solstice Unity Festival</div>
        <div class="event-desc">Celebrating light returning with shared cultural traditions</div>
      </div>
      <div class="event-item">
        <div class="event-date">January 1, 2026</div>
        <div class="event-title">New Year Peace Pledges</div>
        <div class="event-desc">Communities share commitments for the year ahead</div>
      </div>
    </div>
  </div>
</section>

<!-- Footer -->
<footer id="resources">
  <div class="footer-content">
    
    <div class="footer-section">
      <h3>Peacebuilding Organizations</h3>
      <ul class="footer-links">
        <li><a href="https://www.usip.org/" target="_blank" rel="noopener">United States Institute of Peace</a></li>
        <li><a href="https://www.peaceinsight.org/" target="_blank" rel="noopener">Peace Insight</a></li>
        <li><a href="https://www.c-r.org/" target="_blank" rel="noopener">Conciliation Resources</a></li>
        <li><a href="https://www.sfcg.org/" target="_blank" rel="noopener">Search for Common Ground</a></li>
        <li><a href="https://www.internationalalert.org/" target="_blank" rel="noopener">International Alert</a></li>
      </ul>
    </div>

    <div class="footer-section">
      <h3>Reconstruction Resources</h3>
      <ul class="footer-links">
        <li><a href="https://www.worldbank.org/en/topic/fragilityconflictviolence" target="_blank" rel="noopener">World Bank - FCV Framework</a></li>
        <li><a href="https://www.unhcr.org/en-us" target="_blank" rel="noopener">UNHCR - Refugee Support</a></li>
        <li><a href="https://www.unep.org/explore-topics/disasters-conflicts" target="_blank" rel="noopener">UNEP - Post-Conflict Recovery</a></li>
        <li><a href="https://buildchange.org/" target="_blank" rel="noopener">Build Change</a></li>
        <li><a href="https://www.sheltercluster.org/" target="_blank" rel="noopener">Global Shelter Cluster</a></li>
      </ul>
    </div>

    <div class="footer-section">
      <h3>Ecological Restoration</h3>
      <ul class="footer-links">
        <li><a href="https://www.resalliance.org/" target="_blank" rel="noopener">Resilience Alliance</a></li>
        <li><a href="https://www.permaculturenews.org/" target="_blank" rel="noopener">Permaculture Global Network</a></li>
        <li><a href="https://www.plant-for-the-planet.org/" target="_blank" rel="noopener">Plant-for-the-Planet</a></li>
        <li><a href="https://www.ser.org/" target="_blank" rel="noopener">Society for Ecological Restoration</a></li>
      </ul>
    </div>

    <div class="footer-section">
      <h3>Mental Health & Trauma Support</h3>
      <ul class="footer-links">
        <li><a href="https://www.who.int/health-topics/mental-health" target="_blank" rel="noopener">WHO Mental Health</a></li>
        <li><a href="https://www.mhpss.net/" target="_blank" rel="noopener">MHPSS Network</a></li>
        <li><a href="https://www.nctsn.org/" target="_blank" rel="noopener">National Child Traumatic Stress Network</a></li>
        <li><a href="https://www.samhsa.gov/find-help/disaster-distress-helpline" target="_blank" rel="noopener">Disaster Distress Helpline</a></li>
      </ul>
    </div>

  </div>

  <div class="ethics-notice">
    <h4>‚öñÔ∏è Zero Harm & Anti-Coercion Commitment</h4>
    <p>
      This platform is built on principles of consent, transparency, and human dignity. No tracking beyond explained local features. No hidden telemetry. No exploitation of vulnerable populations. No tools that could enable harassment, manipulation, or targeted harm. All data processing is local and user-controlled. Community safety takes precedence over feature complexity.
    </p>
  </div>

  <div class="copyright">
    <p>Peaceweaver Module 25 ‚Ä¢ Unity Through Rebuilding</p>
    <p>Open source ‚Ä¢ Built with hope for a unified future</p>
  </div>
</footer>

</div>

<!-- JavaScript -->
<script>
// Global error handler for debugging
window.onerror = function(msg, url, lineNo, columnNo, error) {
  console.error('JavaScript Error:', {
    message: msg,
    line: lineNo,
    column: columnNo,
    error: error
  });
  return false;
};

// Wrap everything in DOMContentLoaded to ensure DOM is ready
document.addEventListener('DOMContentLoaded', function() {

console.log('%cüïäÔ∏è Unity Through Rebuilding - Initializing...', 'font-size: 16px; font-weight: bold; color: #fbbf24;');

/* ============================================================
   UNITY SPLASH CANVAS ANIMATION
   Particles flowing together representing unity
============================================================ */
try {
const unityCanvas = document.getElementById('unity-canvas');
const unityCtx = unityCanvas ? unityCanvas.getContext('2d') : null;
let unityParticles = [];
let unityAnimationId = null;

if (unityCanvas && unityCtx) {
  function resizeUnityCanvas() {
    unityCanvas.width = window.innerWidth;
    unityCanvas.height = window.innerHeight;
  }
  
  resizeUnityCanvas();
  window.addEventListener('resize', resizeUnityCanvas);
  
  class UnityParticle {
    constructor() {
      this.reset();
    }
    
    reset() {
      // Particles start from edges and move toward center
      const side = Math.floor(Math.random() * 4);
      switch(side) {
        case 0: // top
          this.x = Math.random() * unityCanvas.width;
          this.y = 0;
          break;
        case 1: // right
          this.x = unityCanvas.width;
          this.y = Math.random() * unityCanvas.height;
          break;
        case 2: // bottom
          this.x = Math.random() * unityCanvas.width;
          this.y = unityCanvas.height;
          break;
        case 3: // left
          this.x = 0;
          this.y = Math.random() * unityCanvas.height;
          break;
      }
      
      this.size = Math.random() * 4 + 2;
      this.opacity = Math.random() * 0.8 + 0.2;
      
      // Colors representing unity - blue, yellow, white, red merging to gold
      const colorChoice = Math.random();
      if (colorChoice < 0.25) {
        this.color = { r: 0, g: 87, b: 183 }; // Blue
      } else if (colorChoice < 0.5) {
        this.color = { r: 255, g: 215, b: 0 }; // Yellow
      } else if (colorChoice < 0.75) {
        this.color = { r: 255, g: 255, b: 255 }; // White
      } else {
        this.color = { r: 213, g: 43, b: 30 }; // Red
      }
      
      // Calculate direction toward center
      const centerX = unityCanvas.width / 2;
      const centerY = unityCanvas.height / 2;
      const angle = Math.atan2(centerY - this.y, centerX - this.x);
      
      this.speedX = Math.cos(angle) * (Math.random() * 0.5 + 0.3);
      this.speedY = Math.sin(angle) * (Math.random() * 0.5 + 0.3);
      
      this.life = 1;
      this.maxLife = Math.random() * 200 + 100;
    }
    
    update() {
      this.x += this.speedX;
      this.y += this.speedY;
      this.life++;
      
      // As particles near center, blend to gold
      const centerX = unityCanvas.width / 2;
      const centerY = unityCanvas.height / 2;
      const distToCenter = Math.sqrt(Math.pow(centerX - this.x, 2) + Math.pow(centerY - this.y, 2));
      const maxDist = Math.sqrt(Math.pow(centerX, 2) + Math.pow(centerY, 2));
      const centerProximity = 1 - (distToCenter / maxDist);
      
      if (centerProximity > 0.5) {
        // Blend to gold
        const blendFactor = (centerProximity - 0.5) * 2;
        this.color.r = this.color.r + (251 - this.color.r) * blendFactor;
        this.color.g = this.color.g + (191 - this.color.g) * blendFactor;
        this.color.b = this.color.b + (36 - this.color.b) * blendFactor;
      }
      
      // Fade out near center
      if (distToCenter < 100) {
        this.opacity *= 0.95;
      }
      
      // Reset if life expired or reached center
      if (this.life > this.maxLife || distToCenter < 50 || this.opacity < 0.01) {
        this.reset();
      }
    }
    
    draw() {
      unityCtx.beginPath();
      unityCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
      unityCtx.fillStyle = `rgba(${Math.floor(this.color.r)}, ${Math.floor(this.color.g)}, ${Math.floor(this.color.b)}, ${this.opacity})`;
      unityCtx.shadowBlur = 20;
      unityCtx.shadowColor = `rgba(${Math.floor(this.color.r)}, ${Math.floor(this.color.g)}, ${Math.floor(this.color.b)}, ${this.opacity * 0.8})`;
      unityCtx.fill();
      unityCtx.shadowBlur = 0;
    }
  }
  
  // Create unity particles
  for (let i = 0; i < 100; i++) {
    unityParticles.push(new UnityParticle());
  }
  
  function animateUnityCanvas() {
    unityCtx.clearRect(0, 0, unityCanvas.width, unityCanvas.height);
    
    // Draw center glow
    const centerX = unityCanvas.width / 2;
    const centerY = unityCanvas.height / 2;
    const gradient = unityCtx.createRadialGradient(centerX, centerY, 0, centerX, centerY, 150);
    gradient.addColorStop(0, 'rgba(251, 191, 36, 0.3)');
    gradient.addColorStop(1, 'rgba(251, 191, 36, 0)');
    unityCtx.fillStyle = gradient;
    unityCtx.fillRect(0, 0, unityCanvas.width, unityCanvas.height);
    
    // Update and draw particles
    unityParticles.forEach(particle => {
      particle.update();
      particle.draw();
    });
    
    unityAnimationId = requestAnimationFrame(animateUnityCanvas);
  }
  
  animateUnityCanvas();
}
} catch (error) {
  console.error('Unity canvas error (non-critical):', error);
}

/* ============================================================
   PARTICLE SYSTEM (Main Background)
============================================================ */
const canvas = document.getElementById('particle-canvas');
const ctx = canvas.getContext('2d');
let particles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}

resizeCanvas();
window.addEventListener('resize', resizeCanvas);

class Particle {
  constructor() {
    this.reset();
    this.y = Math.random() * canvas.height;
  }
  
  reset() {
    this.x = Math.random() * canvas.width;
    this.y = -10;
    this.size = Math.random() * 3 + 1;
    this.speedY = Math.random() * 0.5 + 0.2;
    this.speedX = Math.random() * 0.3 - 0.15;
    this.opacity = Math.random() * 0.5 + 0.3;
    const colorChoice = Math.random();
    if (colorChoice < 0.3) {
      this.color = `rgba(251, 191, 36, ${this.opacity})`;
    } else if (colorChoice < 0.6) {
      this.color = `rgba(99, 102, 241, ${this.opacity})`;
    } else {
      this.color = `rgba(168, 85, 247, ${this.opacity})`;
    }
  }
  
  update() {
    this.y += this.speedY;
    this.x += this.speedX;
    this.x += Math.sin(this.y * 0.01) * 0.3;
    
    if (this.y > canvas.height + 10) this.reset();
    if (this.x < -10 || this.x > canvas.width + 10) this.x = Math.random() * canvas.width;
  }
  
  draw() {
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fillStyle = this.color;
    ctx.shadowBlur = 15;
    ctx.shadowColor = this.color;
    ctx.fill();
    ctx.shadowBlur = 0;
  }
}

for (let i = 0; i < 80; i++) {
  particles.push(new Particle());
}

function animateParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  particles.forEach(particle => {
    particle.update();
    particle.draw();
  });
  requestAnimationFrame(animateParticles);
}

animateParticles();

/* ============================================================
   ACHIEVEMENT SYSTEM
============================================================ */
const badges = [
  { id: 'first-visit', emoji: 'üåü', name: 'First Steps', desc: 'Visited the platform', unlocked: false },
  { id: 'explorer', emoji: 'üó∫Ô∏è', name: 'Explorer', desc: 'Viewed 3 domains', unlocked: false },
  { id: 'contributor', emoji: '‚úçÔ∏è', name: 'Contributor', desc: 'Submitted content', unlocked: false },
  { id: 'bridge-builder', emoji: 'üåâ', name: 'Bridge Builder', desc: 'Used 5 tools', unlocked: false },
  { id: 'peaceweaver', emoji: 'üïäÔ∏è', name: 'Peaceweaver', desc: 'Explored all domains', unlocked: false },
  { id: 'storyteller', emoji: 'üìñ', name: 'Storyteller', desc: 'Recorded a testimony', unlocked: false },
  { id: 'documentarian', emoji: 'üì∏', name: 'Documentarian', desc: 'Uploaded photos', unlocked: false },
  { id: 'guide', emoji: 'üß≠', name: 'Guide', desc: 'Read all FAQs', unlocked: false }
];

let unlockedCount = 0;

/* ============================================================
   PROGRESS TRACKING - Initialize BEFORE achievement functions
============================================================ */
let progress = {
  domainsExplored: new Set(),
  toolsUsed: new Set(),
  contributions: 0
};

function unlockBadge(badgeId) {
  const badge = badges.find(b => b.id === badgeId);
  if (badge && !badge.unlocked) {
    badge.unlocked = true;
    unlockedCount++;
    updateBadgeCount();
    showAchievement(badge);
    saveProgress();
  }
}

function showAchievement(badge) {
  const notification = document.getElementById('achievement-notification');
  document.getElementById('achievement-title').textContent = badge.name;
  document.getElementById('achievement-desc').textContent = badge.desc;
  document.querySelector('.achievement-icon').textContent = badge.emoji;
  
  notification.classList.add('show');
  setTimeout(() => notification.classList.remove('show'), 4000);
}

function updateBadgeCount() {
  document.getElementById('badge-count').textContent = unlockedCount;
}

function renderBadges() {
  const container = document.getElementById('badges-container');
  container.innerHTML = badges.map(badge => `
    <div class="badge-item ${badge.unlocked ? 'unlocked' : 'locked'}">
      <span class="badge-emoji">${badge.emoji}</span>
      <div class="badge-name">${badge.name}</div>
      <div class="badge-desc">${badge.desc}</div>
    </div>
  `).join('');
}

function closeBadgesModal() {
  document.getElementById('badges-modal').classList.remove('active');
}

document.getElementById('badges-btn').addEventListener('click', () => {
  document.getElementById('badges-modal').classList.add('active');
  renderBadges();
});

// First visit badge
try {
  unlockBadge('first-visit');
  console.log('First visit badge unlocked');
} catch (error) {
  console.error('Error unlocking first badge:', error);
}

/* ============================================================
   PROGRESS TRACKING FUNCTIONS
============================================================ */
function trackDomainVisit(domainId) {
  progress.domainsExplored.add(domainId);
  updateProgress();
  
  if (progress.domainsExplored.size === 3) unlockBadge('explorer');
  if (progress.domainsExplored.size === 12) unlockBadge('peaceweaver');
}

function trackAction(action) {
  progress.toolsUsed.add(action);
  updateProgress();
  showNotification('Action Tracked', `"${action}" has been recorded`, 'success');
  
  if (progress.toolsUsed.size === 5) unlockBadge('bridge-builder');
}

function updateProgress() {
  const domainsPct = (progress.domainsExplored.size / 12) * 100;
  const toolsPct = (progress.toolsUsed.size / 48) * 100;
  const contribPct = Math.min((progress.contributions / 10) * 100, 100);
  
  document.getElementById('progress-domains').style.width = domainsPct + '%';
  document.getElementById('progress-tools').style.width = toolsPct + '%';
  document.getElementById('progress-contributions').style.width = contribPct + '%';
  
  document.getElementById('domains-count').textContent = progress.domainsExplored.size;
  document.getElementById('tools-count').textContent = progress.toolsUsed.size;
  document.getElementById('contributions-count').textContent = progress.contributions;
  
  saveProgress();
}

function saveProgress() {
  try {
    localStorage.setItem('peaceweaver-progress', JSON.stringify({
      domains: Array.from(progress.domainsExplored),
      tools: Array.from(progress.toolsUsed),
      contributions: progress.contributions,
      badges: badges
    }));
  } catch (error) {
    console.warn('Could not save progress to localStorage:', error);
  }
}

function loadProgress() {
  try {
    const saved = localStorage.getItem('peaceweaver-progress');
    if (saved) {
      const data = JSON.parse(saved);
      progress.domainsExplored = new Set(data.domains || []);
      progress.toolsUsed = new Set(data.tools || []);
      progress.contributions = data.contributions || 0;
      if (data.badges) {
        data.badges.forEach((savedBadge, i) => {
          if (badges[i]) badges[i].unlocked = savedBadge.unlocked;
        });
        unlockedCount = badges.filter(b => b.unlocked).length;
        updateBadgeCount();
      }
      updateProgress();
    }
  } catch (error) {
    console.warn('Could not load progress from localStorage:', error);
  }
}

/* ============================================================
   NOTIFICATION SYSTEM
============================================================ */
function showNotification(title, message, type = 'info') {
  const container = document.getElementById('notification-container');
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  notification.innerHTML = `
    <div class="notification-content">
      <div class="notification-title">${title}</div>
      <div class="notification-message">${message}</div>
    </div>
    <button class="notification-close" onclick="this.parentElement.remove()">√ó</button>
  `;
  container.appendChild(notification);
  
  setTimeout(() => notification.remove(), 5000);
}

/* ============================================================
   THEME TOGGLE
============================================================ */
const themeToggle = document.getElementById('theme-toggle');
let currentTheme = localStorage.getItem('theme') || 'dark';

function setTheme(theme) {
  document.documentElement.setAttribute('data-theme', theme);
  localStorage.setItem('theme', theme);
  currentTheme = theme;
}

themeToggle.addEventListener('click', () => {
  setTheme(currentTheme === 'dark' ? 'light' : 'dark');
});

setTheme(currentTheme);

/* ============================================================
   SEARCH FUNCTIONALITY
============================================================ */
const searchInput = document.getElementById('search-input');
const searchResults = document.getElementById('search-results');

const searchableContent = [
  { title: 'Physical Reconstruction', desc: 'Infrastructure, homes, roads, bridges', section: '#physical' },
  { title: 'Ecological Rebuilding', desc: 'Forests, rivers, wildlife, permaculture', section: '#ecological' },
  { title: 'Cultural Renewal', desc: 'Festivals, food, music, traditions', section: '#cultural' },
  { title: 'Case Studies', desc: 'Northern Ireland, Rwanda, Colombia examples', section: '#case-studies' },
  { title: 'FAQ', desc: 'Common questions about the platform', section: '#faq' },
  { title: 'Events Calendar', desc: 'Upcoming peace-building events', section: '#calendar' },
  { title: 'Progress Dashboard', desc: 'Track your engagement and contributions', section: '#progress' }
];

searchInput.addEventListener('input', (e) => {
  const query = e.target.value.toLowerCase();
  
  if (query.length < 2) {
    searchResults.classList.remove('active');
    return;
  }
  
  const results = searchableContent.filter(item => 
    item.title.toLowerCase().includes(query) || 
    item.desc.toLowerCase().includes(query)
  );
  
  if (results.length > 0) {
    searchResults.innerHTML = results.map(result => `
      <div class="search-result-item" onclick="navigateTo('${result.section}')">
        <div class="search-result-title">${result.title}</div>
        <div class="search-result-desc">${result.desc}</div>
      </div>
    `).join('');
    searchResults.classList.add('active');
  } else {
    searchResults.innerHTML = '<div class="search-result-item">No results found</div>';
    searchResults.classList.add('active');
  }
});

function navigateTo(section) {
  document.querySelector(section).scrollIntoView({ behavior: 'smooth' });
  searchResults.classList.remove('active');
  searchInput.value = '';
}

document.addEventListener('click', (e) => {
  if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
    searchResults.classList.remove('active');
  }
});

/* ============================================================
   INTERACTIVE CHART
============================================================ */
const engagementChart = new Chart(document.getElementById('engagement-chart'), {
  type: 'line',
  data: {
    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
    datasets: [{
      label: 'Community Participation',
      data: [12, 29, 45, 67],
      borderColor: '#6366f1',
      backgroundColor: 'rgba(99, 102, 241, 0.1)',
      tension: 0.4,
      fill: true
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        labels: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary') }
      }
    },
    scales: {
      y: {
        ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') },
        grid: { color: 'rgba(99, 102, 241, 0.1)' }
      },
      x: {
        ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') },
        grid: { color: 'rgba(99, 102, 241, 0.1)' }
      }
    }
  }
});

/* ============================================================
   VOICE RECORDING (Simplified demo)
============================================================ */
let mediaRecorder;
let audioChunks = [];
let recordingInterval;
let recordingSeconds = 0;

document.getElementById('record-btn-1').addEventListener('click', async function() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    mediaRecorder = new MediaRecorder(stream);
    audioChunks = [];
    recordingSeconds = 0;
    
    mediaRecorder.ondataavailable = (event) => {
      audioChunks.push(event.data);
    };
    
    mediaRecorder.onstop = () => {
      const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
      const audioUrl = URL.createObjectURL(audioBlob);
      document.getElementById('playback-1').src = audioUrl;
      document.getElementById('playback-1').style.display = 'block';
      unlockBadge('storyteller');
    };
    
    mediaRecorder.start();
    this.classList.add('recording');
    document.getElementById('stop-btn-1').style.display = 'inline-block';
    
    recordingInterval = setInterval(() => {
      recordingSeconds++;
      const mins = Math.floor(recordingSeconds / 60).toString().padStart(2, '0');
      const secs = (recordingSeconds % 60).toString().padStart(2, '0');
      document.getElementById('timer-1').textContent = `${mins}:${secs}`;
    }, 1000);
    
  } catch (err) {
    showNotification('Microphone Access', 'Please allow microphone access to record', 'warning');
  }
});

document.getElementById('stop-btn-1').addEventListener('click', function() {
  mediaRecorder.stop();
  mediaRecorder.stream.getTracks().forEach(track => track.stop());
  document.getElementById('record-btn-1').classList.remove('recording');
  this.style.display = 'none';
  document.getElementById('save-btn-1').style.display = 'inline-block';
  clearInterval(recordingInterval);
});

document.getElementById('save-btn-1').addEventListener('click', function() {
  progress.contributions++;
  updateProgress();
  showNotification('Testimony Saved', 'Your story has been recorded', 'success');
  unlockBadge('contributor');
  this.style.display = 'none';
});

/* ============================================================
   IMAGE UPLOAD & GALLERY
============================================================ */
const uploadZone = document.getElementById('upload-zone-1');
const fileInput = document.getElementById('file-input-1');
const gallery = document.getElementById('gallery-1');

uploadZone.addEventListener('click', () => fileInput.click());

uploadZone.addEventListener('dragover', (e) => {
  e.preventDefault();
  uploadZone.classList.add('dragover');
});

uploadZone.addEventListener('dragleave', () => {
  uploadZone.classList.remove('dragover');
});

uploadZone.addEventListener('drop', (e) => {
  e.preventDefault();
  uploadZone.classList.remove('dragover');
  handleFiles(e.dataTransfer.files);
});

fileInput.addEventListener('change', (e) => {
  handleFiles(e.target.files);
});

function handleFiles(files) {
  Array.from(files).forEach(file => {
    if (file.type.startsWith('image/')) {
      const reader = new FileReader();
      reader.onload = (e) => {
        addImageToGallery(e.target.result);
      };
      reader.readAsDataURL(file);
    }
  });
}

function addImageToGallery(imageSrc) {
  const item = document.createElement('div');
  item.className = 'gallery-item';
  item.innerHTML = `
    <img src="${imageSrc}" alt="Uploaded image">
    <button class="gallery-item-remove" onclick="this.parentElement.remove(); updateGalleryProgress();">√ó</button>
  `;
  gallery.appendChild(item);
  unlockBadge('documentarian');
  progress.contributions++;
  updateProgress();
}

function updateGalleryProgress() {
  progress.contributions = Math.max(0, progress.contributions - 1);
  updateProgress();
}

/* ============================================================
   FAQ ACCORDION
============================================================ */
document.querySelectorAll('.faq-question').forEach(question => {
  question.addEventListener('click', () => {
    const item = question.parentElement;
    const wasActive = item.classList.contains('active');
    
    document.querySelectorAll('.faq-item').forEach(i => i.classList.remove('active'));
    
    if (!wasActive) {
      item.classList.add('active');
    }
  });
});

/* ============================================================
   CALENDAR
============================================================ */
let currentDate = new Date();

function renderCalendar() {
  const year = currentDate.getFullYear();
  const month = currentDate.getMonth();
  
  document.getElementById('calendar-month').textContent = 
    new Date(year, month).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
  
  const firstDay = new Date(year, month, 1).getDay();
  const daysInMonth = new Date(year, month + 1, 0).getDate();
  
  const grid = document.getElementById('calendar-grid');
  grid.innerHTML = `
    <div class="calendar-day-label">Sun</div>
    <div class="calendar-day-label">Mon</div>
    <div class="calendar-day-label">Tue</div>
    <div class="calendar-day-label">Wed</div>
    <div class="calendar-day-label">Thu</div>
    <div class="calendar-day-label">Fri</div>
    <div class="calendar-day-label">Sat</div>
  `;
  
  for (let i = 0; i < firstDay; i++) {
    grid.innerHTML += '<div class="calendar-day"></div>';
  }
  
  for (let day = 1; day <= daysInMonth; day++) {
    const hasEvent = [10, 21].includes(day) && month === 11; // December events
    grid.innerHTML += `
      <div class="calendar-day ${hasEvent ? 'has-event' : ''}">${day}</div>
    `;
  }
}

document.getElementById('prev-month').addEventListener('click', () => {
  currentDate.setMonth(currentDate.getMonth() - 1);
  renderCalendar();
});

document.getElementById('next-month').addEventListener('click', () => {
  currentDate.setMonth(currentDate.getMonth() + 1);
  renderCalendar();
});

renderCalendar();

/* ============================================================
   PDF DOWNLOAD SIMULATION
============================================================ */
function downloadPDF(title) {
  showNotification('Download Started', `${title} is being prepared...`, 'info');
  setTimeout(() => {
    showNotification('Download Complete', `${title} is ready`, 'success');
  }, 1500);
  trackAction('Download PDF');
}

/* ============================================================
   DOMAIN EXPANSION
============================================================ */
document.querySelectorAll('.domain-header').forEach(header => {
  header.addEventListener('click', () => {
    const block = header.parentElement;
    const wasExpanded = block.classList.contains('expanded');
    block.classList.toggle('expanded');
    
    if (!wasExpanded) {
      const domainId = block.closest('section').id;
      trackDomainVisit(domainId);
    }
  });
});

/* ============================================================
   TOC TOGGLE
============================================================ */
document.getElementById('toc-toggle').addEventListener('click', () => {
  document.getElementById('toc').classList.toggle('open');
});

document.querySelectorAll('#toc a').forEach(link => {
  link.addEventListener('click', (e) => {
    e.preventDefault();
    const targetId = link.getAttribute('href');
    document.querySelector(targetId).scrollIntoView({ behavior: 'smooth' });
    document.getElementById('toc').classList.remove('open');
  });
});

/* ============================================================
   SPLASH SCREEN TRANSITION
============================================================ */
try {
const splashScreen = document.getElementById('splash');
const mainApp = document.getElementById('app');
const enterButton = document.getElementById('enter-btn');

console.log('Splash elements:', { 
  splashScreen: !!splashScreen, 
  mainApp: !!mainApp, 
  enterButton: !!enterButton 
}); // Debug log

if (enterButton && splashScreen && mainApp) {
  enterButton.addEventListener('click', function(e) {
    e.preventDefault();
    console.log('Enter button clicked!'); // Debug log
    
    try {
      // Stop unity canvas animation
      if (typeof unityAnimationId !== 'undefined' && unityAnimationId) {
        cancelAnimationFrame(unityAnimationId);
      }
      if (typeof unityParticles !== 'undefined') {
        unityParticles = [];
      }
    } catch (err) {
      console.log('Error stopping animations (non-critical):', err);
    }
    
    // Add exit animation
    splashScreen.classList.add('splash-exit');
    
    // Transition to main app
    setTimeout(() => {
      splashScreen.style.display = 'none';
      mainApp.style.display = 'block';
      
      // Force reflow
      mainApp.offsetHeight;
      
      requestAnimationFrame(() => {
        mainApp.style.opacity = '1';
        console.log('Main app should be visible now'); // Debug log
      });
    }, 1500);
  });
  
  console.log('Enter button listener attached successfully');
} else {
  console.error('Missing elements:', { enterButton, splashScreen, mainApp });
}
} catch (error) {
  console.error('Splash screen initialization error:', error);
}

/* ============================================================
   INITIALIZATION
============================================================ */
try {
  loadProgress();
  console.log('Progress loaded successfully');
} catch (error) {
  console.error('Error loading progress:', error);
}

console.log('%cüïäÔ∏è Unity Through Rebuilding - Ultimate Edition', 'font-size: 20px; font-weight: bold; color: #fbbf24;');
console.log('%cüé® Enhanced Splash Screen:', 'font-size: 14px; color: #6366f1;');
console.log('%c  ‚Ä¢ Slow-motion particle convergence animation', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Color waves representing unity (üá∫üá¶ + üá∑üá∫ = ü§ù)', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Symbolic elements: dove, hands, heart, bridge', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Particles merge to golden center', 'color: #94a3b8;');
console.log('%c‚ú® New Features:', 'font-size: 14px; color: #6366f1;');
console.log('%c  ‚Ä¢ Interactive data visualizations', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Voice recording for testimonies', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Image galleries', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Achievement badges', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Dark/Light mode', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Search functionality', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Progress tracking', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Case studies & FAQs', 'color: #94a3b8;');
console.log('%c  ‚Ä¢ Events calendar', 'color: #94a3b8;');
console.log('%cüåç Available in: English ‚Ä¢ –†—É—Å—Å–∫–∏–π ‚Ä¢ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞', 'font-size: 12px; color: #10b981;');

console.log('%c‚úÖ Platform initialized successfully!', 'font-size: 14px; font-weight: bold; color: #10b981;');

}); // End DOMContentLoaded
</script>

</body>
</html>
